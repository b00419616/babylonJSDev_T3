import{S,E as l,i as L,e as G,f as z,V as s,A as U,H as F,C as f,D as V,M,b as w,c as _,T as p,a as D,g as b,h as I,d as H,F as K}from"./nativeXRFrame-DOeo_lEL.js";import{A as R,I as X,C as x,B as Y}from"./mrdlInnerquadMaterial-Dww3fJ86.js";import"./ExtrasAsMetadata-C3T-U7sb.js";/* empty css              */function Z(t){const e=new U("camera1",4.75,1,50,new s(0,5,0),t);return e.attachControl(!0),e.lowerBetaLimit=.1,e.upperBetaLimit=Math.PI/2.2,e.lowerRadiusLimit=15,e.upperRadiusLimit=100,e}function W(t,e,o,n){const a=new w(e,n);a.diffuseTexture=new p(o,n),t.material=a}function $(t){const e=new F("ambientLight",new s(0,1,0),t);e.intensity=.1,e.diffuse=new f(.6,.7,1),e.groundColor=new f(.2,.2,.3);const o=new V("light",new s(1,-2,1),t);return o.position=new s(-10,100,-10),o.intensity=.7,o.diffuse=new f(.6,.7,1),o.specular=new f(.8,.9,1),o}function j(t,e){const o=new D(2048,e);o.useBlurExponentialShadowMap=!0,o.blurKernel=16,t.meshes.forEach(a=>{a.name.includes("rockCluster")&&o.addShadowCaster(a)});const n=t.getMeshByName("ground");n&&(n.receiveShadows=!0)}function q(t){const e=M.CreateGround("ground",{width:128,height:128,subdivisions:128},t);return W(e,"moonMat","textures/moon.jpg",t),e}function B(t){let e=M.CreateCylinder("coin",{diameter:2,height:.08},t);const o=new w("coinMat",t);o.diffuseColor=new f(1,1,0),e.material=o;const n=(Math.random()-.5)*50,a=Math.random()*25-5;return e.position=new s(n,5,a),e.rotation.x=Math.PI/2,e}function J(t){const e=[1,2,3,4,8],o=e[Math.floor(Math.random()*e.length)];let n=M.CreatePolyhedron("spacerock",{type:o,size:1.5},t);n.position=new s(0,0,0);const a=new w("rockMat",t);return a.diffuseTexture=new p("./textures/spacedebris.png",t),a.bumpTexture=new p("./textures/spacedebris_n.png",t),a.bumpTexture.level=1.25,console.log("Bump Level is:  ",a.bumpTexture.level),n.material=a,n.setEnabled(!1),n}function Q(t,e,o){const n=J(t);n.setEnabled(!1);const a=[];for(let r=0;r<e;r++){const u=n.clone(`rockClone_${r}`);u&&(u.setEnabled(!0),u.position=o.add(new s((Math.random()-.5)*10,(Math.random()-.5)*5,(Math.random()-.5)*10)),u.scaling=new s(.3+Math.random()*.4,.3+Math.random()*.4,.3+Math.random()*.4),u.rotation=new s(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),a.push(u))}const i=H.MergeMeshes(a,!0,!0,void 0,!1,!0);if(i){i.name="rockCluster";const r=.3+Math.random()*.5,u=.2+Math.random()*.2,c=i.position.y,d=Math.random()*Math.PI*2;return t.registerBeforeRender(()=>{const m=performance.now()*.001;i.position.y=c+Math.sin(m*u+d)*r}),i}else return console.warn("Failed to merge rock cluster."),n}function ee(t,e,o){for(let n=0;n<e;n++){const a=(Math.random()-.5)*o,i=(Math.random()-.5)*o,r=2+Math.random()*3;Q(t,5+Math.floor(Math.random()*6),new s(a,r,i))}}function oe(t){const e=M.CreateBox("skybox",{size:5e3},t),o=new w("skyboxMat",t);o.backFaceCulling=!1;const n=new _("./textures/skybox/skybox",t);return o.reflectionTexture=n,o.reflectionTexture.coordinatesMode=p.SKYBOX_MODE,o.disableLighting=!0,e.material=o,console.log("Skybox created:",e),console.log("Skybox material:",e.material),e}function te(t,e){t.actionManager=new b(t),t.actionManager.registerAction(new I(b.OnKeyDownTrigger,o=>{e[o.sourceEvent.key.toLowerCase()]=!0})),t.actionManager.registerAction(new I(b.OnKeyUpTrigger,o=>{e[o.sourceEvent.key.toLowerCase()]=!1}))}function ne(t,e,o,n){let i=0,r=0;if(e.w&&(r+=1),e.s&&(r-=1),e.a&&(i-=1),e.d&&(i+=1),i!==0||r!==0){const c=new s(i,0,r).normalize();t.rotation.y=Math.atan2(c.x,c.z);const d=new s(Math.sin(t.rotation.y),0,Math.cos(t.rotation.y));t.position.addInPlace(d.scale(.4)),n!=null&&n.isPlaying||(o==null||o.stop(),n==null||n.start(!0))}else n!=null&&n.isPlaying&&(n.stop(),o==null||o.start(!0))}function ae(t,e,o,n){return e&&t.getChildMeshes().some(a=>a.intersectsMesh(e,!1))&&(console.log("PING!"),n.play(),e.dispose(),e=B(o)),e}function re(t,e){const o=R.CreateFullscreenUI("UI"),n=new X("volumeToggle","ui/vol_unmute.png");n.width="60px",n.height="60px",n.horizontalAlignment=x.HORIZONTAL_ALIGNMENT_RIGHT,n.verticalAlignment=x.VERTICAL_ALIGNMENT_TOP,n.top="800px",n.left="0px",n.paddingRight="10px";let a=!0;return n.source="ui/vol_mute.png",n.onPointerUpObservable.add(()=>{a=!a,n.source=a?"ui/vol_mute.png":"ui/vol_unmute.png",console.log(a?"Muted":"Unmuted"),t.setVolume(a?0:.5),e.setVolume(a?0:.25)}),o.addControl(n),n}function ie(t){var e,o,n,a,i;const r=new S(t),u=Z(r);t.getRenderingCanvas();const c=$(r),d=q(r);oe(r);let m=B(r);console.log("AudioEngine present? →",l.audioEngine!==void 0),console.log("Can use Web Audio? →",(e=l.audioEngine)===null||e===void 0?void 0:e.canUseWebAudio),console.log("AudioContext state →",(n=(o=l.audioEngine)===null||o===void 0?void 0:o.audioContext)===null||n===void 0?void 0:n.state),console.log("AudioEngine.unlocked →",(a=l.audioEngine)===null||a===void 0?void 0:a.unlocked),l.audioEngine.unlock(),console.log("Attempt 2: AudioEngine.unlocked →",(i=l.audioEngine)===null||i===void 0?void 0:i.unlocked),j(r,c);let C=new L("coin","./audio/coin.wav",r,()=>console.log("Coin sound loaded successfully."),{autoplay:!1,loop:!1,volume:0}),T=new L("ambience","./audio/spaceambience.mp3",r,()=>console.log("music loaded successfully."),{autoplay:!0,loop:!1,volume:0});const k={};let N=re(T,C);return G.ImportMesh("","./models/","alien.glb",r,(O,ge,he,E)=>{const g=new z("playerRoot",r);O.forEach(h=>h.parent=g),g.scaling=new s(.05,.05,.05),g.rotation=new s(Math.PI/2,0,0);const v=E.find(h=>h.name.toLowerCase().includes("idle")),P=E.find(h=>h.name.toLowerCase().includes("walk"));v==null||v.start(!0),te(r,k),r.onBeforeRenderObservable.add(()=>{ne(g,k,v,P),m=ae(g,m,r,C),m.rotation.z+=.07})}),ee(r,20,128),{scene:r,camera:u,light:c,ground:d,coinSound:C,ambientSound:T,volumeToggle:N}}function se(t){const e=R.CreateFullscreenUI("UI"),o=Y.CreateSimpleButton("startBtn","Start Game");return o.width="150px",o.height="40px",o.color="red",o.background="black",o.horizontalAlignment=x.HORIZONTAL_ALIGNMENT_CENTER,o.verticalAlignment=x.VERTICAL_ALIGNMENT_CENTER,o.onPointerUpObservable.add(()=>{var n;(n=l.audioEngine)===null||n===void 0||n.unlock(),console.log("Audio unlocked via menu click"),ce(t)}),e.addControl(o),o}function ue(t){const e=M.CreateBox("skybox",{size:5e3},t),o=new w("skyboxMat",t);o.backFaceCulling=!1;const n=new _("./textures/skybox/skybox",t);return o.reflectionTexture=n,o.reflectionTexture.coordinatesMode=p.SKYBOX_MODE,o.disableLighting=!0,e.material=o,console.log("Skybox created:",e),console.log("Skybox material:",e.material),e}function le(t){const e=new K("menuCamera",new s(0,10,-30),t);return e.setTarget(new s(0,10,0)),e.inputs.clear(),e}function ce(t){const e=ie(t);t.runRenderLoop(()=>{e.scene.render()})}function de(t){const e=new S(t),o=ue(e),n=le(e),a=se(t);return{scene:e,skybox:o,camera:n,startButton:a}}const y=document.createElement("canvas");y.id="renderCanvas";document.body.appendChild(y);let A=new l(y,!0,{audioEngine:!0},!0);const me=de(A);A.runRenderLoop(()=>{me.scene.render()});
